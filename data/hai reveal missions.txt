# Copyright (c) ???? by Michael Zahniser
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.  See the GNU General Public License for more details.

mission "hai secret leaker begins"
	landing
	invisible
	to offer
		has "free worlds plot completed"
	on offer
		event "pug media coverage" 20 30
		fail

event "pug media coverage"

mission "event: pug media coverage"
	landing
	source
		government "Republic" "Syndicate" "Free Worlds"
		attributes "spaceport"
	to offer
		has "event: pug media coverage"
	on offer
		conversation
			`It's been weeks now but as you walk through the spaceport you can't help but notice that coverage on the events of the Pug invasion still continues to dominate headlines.`
			`	As you look around you see that experts and officials have given way to talking heads and theorists. Some of them are saying what you yourself suspect, that the Pug invasion was a ploy to cause humanity to band together, learn to resolve differences without conflict and learn not to tolerate the sorts of extremism that lead to the events that precipitated the war.`
			`	Others...`
			`	You sigh deeply as you watch some paranoid fringe world politician demand that the edges of human space be better understood, that threats and even potential threats must clearly exist beyond what is already known and that it was the responsibility of the government to find out and inform the people.`
			`	Your thoughts, you keep to yourself.`
			event "hai secret leaks" 10 15
				decline

event "hai secret leaks"

mission "event: hai secret leaks A"
	landing
	source
		government "Republic" "Syndicate"
		attributes "spaceport"
	to offer
		has "event: hai secret leaks"
		not "event: hai secret leaks B: offered"
	on offer
		conversation
			`You are relaxing at the spaceport while your ship refuels after conducting a spot of business when a breaking news broadcast comes on; not urgent enough to actually interrupt scheduled content, but urgent enough to fill the first ad break.`
			`	The severe looking anchorwoman bores down the camera with an expression that demands attention.`
			`	"An ex-crewman employed by an itinerant trader has come forward to media in the Free Worlds about hostile aliens just beyond our borders! He claims to have brought video proof of an ongoing conflict that threatens to spill over and drag all of humanity back to war. Stay tuned for our full segment at 6."`
			`	You raise your eyebrows with surprise.`
			`	That such news should come out so soon after the Pug smacks of a hoax. A quick glance at the clock shows you only have ten minutes to wait so you stick around for the full segment out of curiosity.`
			`	Right on schedule the news returns with the severe anchorwoman. It turns out that the crewman in question had been picked up by a minor media outlet on Tarazed. He had apparently travelled many weeks before deciding to seek the media in order to avoid being shut down by republic intelligence if he contacted media elsewhere. The man is fairly young, and very well presented, though he has a bit of the paranoid about him that is plain to see even through a screen.`
			branch "hai knowledge"
			has "First Contact: Hai: offered"
			`	A clip of alien space ships in combat with weapons quite unlike anything produced in human space is shown, you've seen things, but not this.`
			`	It is only after this that the anchorwoman reveals that, while this was initially treated as a hoax, one of their own reporters posed a timely question to a well-respected trader and caused quite the stir when he slipped up and confirmed the existance of the aliens known as 'Hai'.`
			`	This is, of course, ridiculous... but maybe it would be good to go investigate this for yourself. You listen in to collect the relevant details for future reference.`
			decline	
			label "hai knowledge"
			`	A clip of alien space ships in combat with weapons quite unlike anything produced in human space is shown, and you recognise shield beetles hammering away at each other.`
			`	It is only after this that the anchorwoman reveals that, while this was initially treated as a hoax, one of their own reporters posed a timely question to a well-respected trader and caused quite the stir when he slipped up and confirmed the existance of the aliens known as 'Hai'.`
			`	You suspect it might be time to go visit your Hai friends again and see what's going on.`
			fail
	
mission "event: hai secret leaks B"
	landing
	source
		government "Free Worlds"
		attributes "spaceport"
	to offer
		has "event: hai secret leaks"
		not "event: hai secret leaks A: offered"
	on offer
		conversation
			`You are relaxing at the spaceport while your ship refuels after conducting a spot of business. On the viewscreen is some talk show or other, not something you specifically paid attention to but apparently a quite popular one out of Tarazed.`
			`	A young and fresh-faced man who looks incredibly ill at ease has just been brought out as a surprise guest by the host Jonathon Camembert.`
			`	"So now in our surprise segment let me introduce you to Ronald. He once crewed on one of these big trade ships but after seeing what he saw, he just had to come foward!"`
			`	The host stresses the word 'had' so much his voice squeeks but the audience's attention has certainly been gained.`
			`	"But first, lets take a look at a clip."`
			`	You raise your eyebrows with surprise.`
			branch "hai knowledge"
			has "First Contact: Hai: offered"
			`	A clip of alien space ships in combat with weapons quite unlike anything produced in human space is shown, you've seen things, but not this.`
			`	When it's finished the young man, who is very well presented, but clearly has a bit of the paranoid about him that is plain to see even through a screen is encouraged to talk about where he got the footage. he talks at length about an ongoing conflict that threatens to spill over and drag all of humanity back to war. A war waged by an alien species known as the 'Hai'.`
			`	This is, of course, ridiculous... but maybe it would be good to go investigate this for yourself. You listen in to collect the relevant details for future reference.`
			decline	
			label "hai knowledge"
			`	A clip of alien space ships in combat with weapons quite unlike anything produced in human space is shown, and you recognise shield beetles hammering away at each other.`
			`	When it's finished the young man, who is very well presented, but clearly has a bit of the paranoid about him that is plain to see even through a screen is encouraged to talk about where he got the footage. he talks at length about an ongoing conflict that threatens to spill over and drag all of humanity back to war. A war waged by an alien species known as the 'Hai'.`
			`	You suspect it might be time to go visit your Hai friends again and see what's going on.`
			fail

#Both of these accept automatically with either secret leaks scenarios above - the non-relevant mission then fails based on whether you get the text for knowing about the Hai or not.

mission "leaks 1A: visit the hai"
	name "Visit the Hai on Allhome"
	description "It seems like events may be taking away the hai's valued secrecy, best see if things are ok."
	landing
	destination "Allhome"
	to offer
		has "event: hai secret leaks"
	to fail
		or
			has "event: hai secret leaks A: declined"
			has "event: hai secret leaks B: declined"
	to complete
		has "leaks 1B: investigate the hai: failed"
	
mission "leaks 1B: investigate the hai"
	name "Investigate the Hai"
	description "A secret and violent alien race that Traders have known about for ages? Preposterous; go find out what's really going on."
	landing
	waypoint "Ultima Thule"
	destination "Allhome"
	to offer
		has "event: hai secret leaks"
	to fail
		or
			has "event: hai secret leaks A: failed"
			has "event: hai secret leaks B: failed"
	to complete
		has "leaks 1A: visit the hai: failed"
	
#Branch A is if you already have Hai first contact - sends you directly to Hai Home (detour if you haven't visited Wah Ki yet).
	
	
	
	
#Branch B is if you haven't met the Hai before, fires after First contact happens, sends you on a short guided tour of Hai space.
	
	
	
	
	
#Branches merge here.
	
	
